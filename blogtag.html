---
layout: page
title: Blogs Tag
permalink: /blogtag
---

<div class="wrapper">
    <div class = "renderblog"></div>
    <ul id="pagination-demo" class="paginationqw"></ul>

</div>

<script src="js/jquery.twbsPagination.min.js"></script>
<script type="text/javascript">
    $(document).ready(function() {

        var query = getUrlVars();
        var queryStingval = query['tag'].replace("%20", " ");
        $('h1.page-header').text("Blog: " + queryStingval );

        console.log(queryStingval);
        fetchJsonData();

        function getUrlVars()
        {
            var vars = [], hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for(var i = 0; i < hashes.length; i++)
            {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }

        function fetchJsonData() {
            var dataarray =[];
            $.getJSON("/blog.json", function (data) {
                //console.log(data);
                $.each(data,function(l) {
                    if(data[l].tags.indexOf(queryStingval) >= 0) {
                        dataarray.push(data[l]);
                    }
                });

                //console.log(data);
                if(dataarray.length >= 0) {
                    renderJsonData(dataarray)
                }
                //renderJsonData(data)
            });
        }

        function renderJsonData(data) {
            //console.log(data);
            var perpage = 5;
            var datalimit = perpage;
            var maxdatalength = data.length;
            var totallinks = Math.ceil(maxdatalength/perpage);
            var renderblog = $('div.renderblog');
            console.log(totallinks);

            $('#pagination-demo').twbsPagination({
                totalPages: totallinks,
                visiblePages: 5,
                next: 'Next',
                prev: 'Prev',
                onPageClick: function (event, page) {

//                 var current_page = page;
                    datalimit =  (page*perpage);
                    var start;
                    if(page == 1) {
                        start = 0;
                    } else {
                        start = (datalimit+perpage)-(2*perpage);
                        datalimit = (datalimit+perpage)-perpage;
                    }

                    console.log( page + " start " + start + " limit " + datalimit );
                    renderblog.empty();
                    var blogcategory = '';
                    for(var i = start; i < datalimit; i++ ) {
                        if(data[i] === undefined) {
                            continue;
                        }
                        if(data[i].categories.indexOf(',') > -1) {
//                         blogcategory += '<a href = "/blog-category/' +
                            var getblogcat = data[i].categories.split(",");
                            for(var j = 0; j < getblogcat.length; j++ ) {
                                blogcategory += '<a href="/blog-cat?cat=' + getblogcat[j].trim() + '">' + getblogcat[j] +'</a>' + ' , ';
                            }
                        } else {
                            blogcategory = '<a href="/blog-cat?cat=' + data[i].categories.trim() + '">' + data[i].categories +'</a>';
                        }

                        var blogtag = '';
                        if(data[i].tags != '') {
                            if(data[i].tags.indexOf(',') > -1) {
//                         blogcategory += '<a href = "/blog-category/' +
                                var getblogtag = data[i].tags.split(",");
                                for(var k = 0; k < getblogcat.length; k++ ) {
                                    blogtag += '<a href="/blogtag?tag=' + getblogtag[k] + '">' + getblogtag[k] +'</a>' + ' , ';
                                }
                            } else {
                                blogtag = '<a href="/blogtag?tag=' + data[i].tags.trim() + '">' + data[i].tags +'</a>';
                            }
                        } else {
                            blogtag = '';
                        }

                        var blogDiv = '<div class="blog"><h2><a class="post-link" href="'+ data[i].url +'">'+ data[i].title +'</a></h2>' + '' +
                                '<div class="post_author">By: '+ data[i].author + '</div><div class="post_date">'+ data[i].date + '</div><div class="post_categories"> Category: ' + blogcategory + '</div><div class="post_tag"> Tags: ' + blogtag +'</div>' +
                                '<div class="post_content">' + data[i].content + '</div><div class="read_more"><a href="' + data[i].url + '" class="btn btn-default">Read More</a></div></div>';
                        renderblog.append(blogDiv);
                    }

                }
            });
        }
    });
</script>